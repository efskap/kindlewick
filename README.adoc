= Kindlewick

++++
<img src="screenshot.png" alt="Screenshot" align="right" width="40%" >
++++

This is a Go program to fetch Wiktionary page content from their API, (optionally) intersect it with a frequency wordlist (as the database is probably too big otherwise), and then produce an HTML file that, together with an .opf file, can be converted to mobi and used on your Kindle for in-book lookups.

*Note:* My target lang is Finnish, so that's what I wrote this program in mind with. Hopefully it'll work out of the box for your TL too, but there's always the possibility that it does something wonky in the inflection table. Fear not though, goquery is easy to work with!

== Instructions


1. Install Go. Probably 1.12.

2. Download a frequency wordlist for your language https://invokeit.wordpress.com/frequency-word-lists/[from here] if possible. Otherwise the file might be too big for `kindlegen` to handle.

3. Download `kindlegen` for your platform https://www.amazon.com/gp/feature.html?ie=UTF8&docId=1000765211[from here].

4. Edit the metadata in `dict.opf`. Don't forget to modify **`<DictionaryInLanguage>`**! Set it to the https://en.wikipedia.org/wiki/List_of_ISO_639-1_codes[ISO 639-1 code from here].
`cover.png` doesn't matter much as it won't show up as a book by default.

5. On Linux/MacOS, run 

[source, sh]
----
go run kindling.go -freqlist <(head -n 50000 fi.txt)
kindlegen dict.opf -verbose -c2 -o enfi.mobi
----

On Windows you'll have to trim down your frequency wordlist somehow else, idk.


== Q&A

--

How are inflections acquired?::
Basically it just takes every span inside a table cell, and if it consists of multiple words, takes the last one (`olen odottanut` -> `odottanut`, since you can only look up a single word at a time on Kindle), and filters out duplicates.

Why not consult the frequency list _before_ downloading every single page?::
Because frequency lists usually have inflected forms of words, and if you only see `olen` in the list you won't know you have to download the lemma form `olla`. Ergo, download everything and check the headword and all inflections against the list.

--
